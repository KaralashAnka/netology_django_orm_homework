# Задание 1: Импорт каталога телефонов из CSV

## Описание задачи

Создание Django-приложения для импорта и отображения каталога мобильных телефонов из CSV файла.

## Структура проекта

```
task1_phones/
├── manage.py                    # Управление Django проектом
├── phones.csv                   # CSV файл с данными телефонов
├── import_phones.py             # Скрипт импорта данных
├── requirements.txt             # Зависимости проекта
├── phones_project/              # Настройки проекта
│   ├── __init__.py
│   ├── settings.py             # Конфигурация Django
│   ├── urls.py                 # Главные URL маршруты
│   ├── wsgi.py
│   └── asgi.py
└── phones/                      # Django приложение
    ├── __init__.py
    ├── models.py               # Модель Phone
    ├── views.py                # Представления
    ├── urls.py                 # URL маршруты приложения
    ├── admin.py                # Настройка админки
    ├── apps.py
    ├── migrations/             # Миграции БД
    └── templates/phones/       # HTML шаблоны
        ├── base.html
        ├── phone_list.html
        └── phone_detail.html
```

## Реализованные функции

### Модель Phone (models.py)
- `name` - название телефона
- `price` - цена (DecimalField)
- `image` - URL изображения
- `release_date` - дата выпуска
- `lte_exists` - поддержка LTE (boolean)
- `slug` - уникальный идентификатор (автоматически генерируется из названия)

### Представления (views.py)
1. **phone_list** - список всех телефонов с картинками и основной информацией
   - Поддержка сортировки через GET параметр `sort`
   - `sort=name` - по названию (по умолчанию)
   - `sort=min_price` - по возрастанию цены
   - `sort=max_price` - по убыванию цены
2. **phone_detail** - детальная страница конкретного телефона по slug

### URL маршруты
- `/` - главная страница со списком телефонов
- `/?sort=name` - сортировка по названию (по умолчанию)
- `/?sort=min_price` - сортировка по цене (сначала дешёвые)
- `/?sort=max_price` - сортировка по цене (сначала дорогие)
- `/catalog/<slug>/` - страница конкретного телефона

### Импорт данных
Скрипт `import_phones.py` считывает данные из CSV файла и создает записи в БД:
- Автоматическое создание slug из названия
- Парсинг даты из формата YYYY-MM-DD
- Обработка boolean значений для LTE
- Обработка ошибок при импорте

## Установка и запуск

### 1. Установка зависимостей

```bash
# Создание виртуального окружения (рекомендуется)
python3 -m venv venv
source venv/bin/activate  # Linux/Mac
# или
venv\Scripts\activate     # Windows

# Установка Django
pip install -r requirements.txt
```

### 2. Создание базы данных

```bash
# Создание миграций
python manage.py makemigrations

# Применение миграций
python manage.py migrate
```

### 3. Импорт данных из CSV

```bash
# Запуск скрипта импорта
python manage.py shell < import_phones.py
```

Вы увидите вывод:
```
Существующие данные удалены.
✓ Импортирован: iPhone X (slug: iphone-x)
✓ Импортирован: iPhone 8 (slug: iphone-8)
...
==================================================
Импорт завершен! Добавлено телефонов: 10
==================================================
```

### 4. Запуск сервера

```bash
python manage.py runserver
```

Откройте в браузере: `http://127.0.0.1:8000/`

### 5. (Опционально) Создание суперпользователя

```bash
python manage.py createsuperuser
```

Административная панель доступна по адресу: `http://127.0.0.1:8000/admin/`

## Формат CSV файла

CSV файл должен иметь следующие колонки (разделитель `;`):

```csv
name;price;image;release_date;lte_exists
iPhone X;73999;https://example.com/image.jpg;2017-11-03;true
```

Где:
- `name` - строка
- `price` - число (может быть с десятичными знаками)
- `image` - URL изображения
- `release_date` - дата в формате YYYY-MM-DD
- `lte_exists` - true/false (также допустимы: yes/no, 1/0)

## Особенности реализации

### 1. Автоматическая генерация slug
В модели Phone переопределен метод `save()`, который автоматически создает slug из названия телефона при первом сохранении:

```python
def save(self, *args, **kwargs):
    if not self.slug:
        self.slug = slugify(self.name)
    super().save(*args, **kwargs)
```

### 2. Сортировка каталога
Реализована динамическая сортировка через GET параметры:
```python
sort_by = request.GET.get('sort', 'name')

if sort_by == 'name':
    phones = Phone.objects.all().order_by('name')
elif sort_by == 'min_price':
    phones = Phone.objects.all().order_by('price')
elif sort_by == 'max_price':
    phones = Phone.objects.all().order_by('-price')
```

Доступные варианты сортировки:
- **По названию** - алфавитный порядок
- **Сначала дешёвые** - от минимальной к максимальной цене
- **Сначала дорогие** - от максимальной к минимальной цене

### 3. Responsive дизайн
Шаблоны используют CSS Grid для адаптивного отображения карточек телефонов. На мобильных устройствах карточки выстраиваются в одну колонку.

### 4. Обработка ошибок изображений
Если изображение не загружается, автоматически подставляется placeholder:
```html
<img src="{{ phone.image }}" onerror="this.src='https://via.placeholder.com/300x200?text=No+Image'">
```

### 5. Административная панель
Настроена кастомная админка с:
- Списком полей для отображения
- Фильтрами по LTE и дате выпуска
- Поиском по названию
- Автозаполнением slug

## Соответствие стандартам кодирования

Код соответствует PEP 8 и стандартам Нетологии:
- Используются docstrings для документации функций и классов
- Осмысленные имена переменных на русском и английском языках
- Правильная структура проекта Django
- Разделение логики (models, views, urls)
- Комментарии в ключевых местах

## Тестирование

После импорта данных проверьте:
1. Главную страницу - должны отображаться все телефоны
2. Кнопки сортировки:
   - "По названию" - телефоны должны быть отсортированы алфавитно
   - "Сначала дешёвые" - от минимальной к максимальной цене
   - "Сначала дорогие" - от максимальной к минимальной цене
3. Клик на карточку телефона - должна открываться детальная страница
4. URL вида `/catalog/iphone-x/` - должен работать напрямую
5. Админ-панель - возможность просмотра и редактирования телефонов

## Возможные улучшения

- Добавить пагинацию на странице списка
- Реализовать фильтрацию по дате и наличию LTE
- Добавить поиск по названию
- ~~Реализовать сортировку (по цене, названию)~~ ✅ Реализовано
- Добавить возможность загрузки изображений на сервер
- Реализовать API для работы с каталогом
- Добавить сравнение телефонов

## Автор

Решение выполнено для курса "Django: создание функциональных веб-приложений" от Нетологии.
